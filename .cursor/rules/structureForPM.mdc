---
alwaysApply: false
---

# ğŸ—ï¸ Prometheus Project Structure & Architecture Rules

## ğŸ“‹ Project Overview

PrometheusëŠ” ë‹¤ì¤‘ í”„ë¡œì íŠ¸ë¡œ êµ¬ì„±ëœ ëª¨ë…¸ë ˆí¬ êµ¬ì¡°ì…ë‹ˆë‹¤:

- **Prometheus-FE**: React/Next.js ê¸°ë°˜ í”„ë¡ íŠ¸ì—”ë“œ (ëª¨ë…¸ë ˆí¬)
- **Prometheus-Web-API**: Python FastAPI ê¸°ë°˜ ë°±ì—”ë“œ
- **Prometheus-Web-Front**: Nuxt.js ê¸°ë°˜ ë ˆê±°ì‹œ í”„ë¡ íŠ¸ì—”ë“œ
- **yinsh-fe**: ê²Œì„ ì•± í”„ë¡œì íŠ¸ (React Native + Next.js)

## ğŸ¯ Core Architecture Principles

### 1. ë‹¨ë°©í–¥ ì˜ì¡´ì„± (Unidirectional Dependency)
```
Pages/Components â†’ Hooks â†’ API â†’ DTOs
       â†“            â†“      â†“     â†“
    Types    â†   Types â† Types â† Types
```

### 2. ê³„ì¸µë³„ ì±…ì„ ë¶„ë¦¬ (Layer Separation of Concerns)

#### ğŸ“± UI Layer (Pages/Components)
- **ì±…ì„**: ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ ë Œë”ë§, ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ì²˜ë¦¬
- **í—ˆìš© Import**: `@prometheus-fe/hooks`, `@prometheus-fe/types`, `@prometheus-fe/stores`
- **ê¸ˆì§€ Import**: `@prometheus-fe/api`, DTO ì§ì ‘ import

#### ğŸ£ Business Logic Layer (Hooks)
- **ì±…ì„**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬, ìƒíƒœ ê´€ë¦¬ (ë¡œì»¬), API í˜¸ì¶œ ë° ì—ëŸ¬ ì²˜ë¦¬
- **í—ˆìš© Import**: `@prometheus-fe/api`, `@prometheus-fe/types`, `@prometheus-fe/stores`
- **ê¸ˆì§€ Import**: DTO ì§ì ‘ import (APIë¥¼ í†µí•´ì„œë§Œ ì ‘ê·¼)

#### ğŸ“¡ Data Access Layer (API)
- **ì±…ì„**: HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬, ë°ì´í„° ë³€í™˜ (DTO â†” Domain), ì—ëŸ¬ í•¸ë“¤ë§
- **í—ˆìš© Import**: `@prometheus-fe/types`, DTO files
- **ê¸ˆì§€ Import**: Hooks, Pages, Stores

#### ğŸ“ DTO Layer (Data Transfer Objects)
- **ì±…ì„**: API ìš”ì²­/ì‘ë‹µ íƒ€ì… ì •ì˜
- **í—ˆìš© Import**: `@prometheus-fe/types`
- **ê¸ˆì§€ Import**: API, Hooks, Pages, Stores

#### ğŸ”§ Types Layer (Domain Types)
- **ì±…ì„**: ë„ë©”ì¸ ê°ì²´ íƒ€ì… ì •ì˜
- **í—ˆìš© Import**: ì—†ìŒ (ì™„ì „íˆ ë…ë¦½ì )
- **ê¸ˆì§€ Import**: ëª¨ë“  ë‹¤ë¥¸ ë ˆì´ì–´

#### ğŸª Stores Layer (Global State)
- **ì±…ì„**: ì „ì—­ ìƒíƒœ ê´€ë¦¬, ìƒíƒœ ì§€ì†ì„±
- **í—ˆìš© Import**: `@prometheus-fe/types`
- **ê¸ˆì§€ Import**: API, Hooks, Pages (ë‹¨, Pagesì—ì„œëŠ” Stores ì‚¬ìš© ê°€ëŠ¥)

## ğŸ“ File Structure & Naming Conventions

### Prometheus-FE Structure
```
Prometheus-FE/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web/                    # Next.js ì›¹ ì•±
â”‚   â”‚   â”œâ”€â”€ app/               # App Router í˜ì´ì§€
â”‚   â”‚   â”‚   â”œâ”€â”€ admin/         # ê´€ë¦¬ì í˜ì´ì§€
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/          # ì¸ì¦ í˜ì´ì§€
â”‚   â”‚   â”‚   â”œâ”€â”€ project/       # í”„ë¡œì íŠ¸ ê´€ë¦¬ í˜ì´ì§€
â”‚   â”‚   â”‚   â””â”€â”€ layout.tsx     # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â””â”€â”€ components/    # ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì»´í¬ë„ŒíŠ¸
â”‚   â””â”€â”€ mobile/                # React Native ëª¨ë°”ì¼ ì•±
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ types/                 # ğŸ”§ Domain Types Layer
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ Project.d.ts   # í”„ë¡œì íŠ¸ ë„ë©”ì¸ íƒ€ì…
â”‚   â”‚       â”œâ”€â”€ User.d.ts      # ì‚¬ìš©ì ë„ë©”ì¸ íƒ€ì…
â”‚   â”‚       â””â”€â”€ index.ts       # íƒ€ì… export
â”‚   â”œâ”€â”€ api/                   # ğŸ“¡ Data Access Layer
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ projectApi.ts  # í”„ë¡œì íŠ¸ API í´ë˜ìŠ¤
â”‚   â”‚       â”œâ”€â”€ userApi.ts     # ì‚¬ìš©ì API í´ë˜ìŠ¤
â”‚   â”‚       â”œâ”€â”€ dto/           # ğŸ“ DTO Layer
â”‚   â”‚       â”‚   â”œâ”€â”€ project.dto.ts  # í”„ë¡œì íŠ¸ ìš”ì²­/ì‘ë‹µ íƒ€ì…
â”‚   â”‚       â”‚   â””â”€â”€ user.dto.ts     # ì‚¬ìš©ì ìš”ì²­/ì‘ë‹µ íƒ€ì…
â”‚   â”‚       â””â”€â”€ index.ts       # API export
â”‚   â”œâ”€â”€ hooks/                 # ğŸ£ Business Logic Layer
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ useProject.ts  # í”„ë¡œì íŠ¸ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚       â”œâ”€â”€ useUser.ts     # ì‚¬ìš©ì ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚       â””â”€â”€ index.ts       # Hook export
â”‚   â”œâ”€â”€ stores/                # ğŸª Global State Layer
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ authStore.ts   # ì¸ì¦ ì „ì—­ ìƒíƒœ
â”‚   â”‚       â”œâ”€â”€ userStore.ts   # ì‚¬ìš©ì ì „ì—­ ìƒíƒœ
â”‚   â”‚       â””â”€â”€ index.ts       # Store export
â”‚   â””â”€â”€ context/               # React Context Providers
â”‚       â””â”€â”€ src/
â”‚           â”œâ”€â”€ ApiProvider.tsx # API ì»¨í…ìŠ¤íŠ¸
â”‚           â””â”€â”€ index.ts       # Context export
```

### Naming Conventions

#### íŒŒì¼ëª… ê·œì¹™
- **Types**: `Project.d.ts`, `User.d.ts`, `Auth.d.ts`
- **DTOs**: `project.dto.ts`, `user.dto.ts`, `auth.dto.ts`
- **APIs**: `projectApi.ts`, `userApi.ts`, `authApi.ts`
- **Hooks**: `useProject.ts`, `useUser.ts`, `useAuth.ts`
- **Stores**: `projectStore.ts`, `userStore.ts`, `authStore.ts`
- **Pages**: `page.tsx`, `layout.tsx`, `loading.tsx`, `error.tsx`
- **Components**: `ProjectForm.tsx`, `UserModal.tsx`, `AuthButton.tsx`

#### ì¸í„°í˜ì´ìŠ¤/íƒ€ì…ëª… ê·œì¹™
- **Domain Types**: `Project`, `User`, `Auth`
- **Request DTOs**: `CreateProjectRequest`, `UpdateUserRequest`, `LoginRequest`
- **Response DTOs**: `CreateProjectDto`, `GetProjectsDto`, `LoginDto`
- **Hook ë°˜í™˜ íƒ€ì…**: `useProject()`, `useUser()`, `useAuth()`
- **Store íƒ€ì…**: `AuthStore`, `UserStore`

## ğŸš« Import Restrictions Matrix

| Layer | í—ˆìš©ë˜ëŠ” Import | ê¸ˆì§€ë˜ëŠ” Import |
|-------|----------------|-----------------|
| **Pages/Components** | `@prometheus-fe/hooks`<br/>`@prometheus-fe/types`<br/>`@prometheus-fe/stores` | `@prometheus-fe/api`<br/>DTO ì§ì ‘ import |
| **Hooks** | `@prometheus-fe/api`<br/>`@prometheus-fe/types`<br/>`@prometheus-fe/stores` | DTO ì§ì ‘ import<br/>(APIë¥¼ í†µí•´ì„œë§Œ ì ‘ê·¼) |
| **API** | `@prometheus-fe/types`<br/>DTO files | Hooks, Pages, Stores |
| **DTOs** | `@prometheus-fe/types` | API, Hooks, Pages, Stores |
| **Types** | ì—†ìŒ (ë…ë¦½ì ) | ëª¨ë“  ë‹¤ë¥¸ ë ˆì´ì–´ |
| **Stores** | `@prometheus-fe/types` | API, Hooks, Pages |

## ğŸ”„ Data Flow Rules

### 1. ìƒì„± íë¦„ (Create Flow)
```
Form Data (UI) â†’ Hook (validation) â†’ API (transform) â†’ DTO â†’ Backend
```

### 2. ì¡°íšŒ íë¦„ (Read Flow)
```
Backend â†’ DTO â†’ API (transform) â†’ Domain Type â†’ Hook (cache) â†’ UI
```

### 3. ìˆ˜ì • íë¦„ (Update Flow)
```
Form Data (UI) â†’ Hook (merge) â†’ API (transform) â†’ DTO â†’ Backend
                     â†“
                Local State Update
```

### 4. ì—ëŸ¬ ì²˜ë¦¬ íë¦„ (Error Flow)
```
API Error â†’ Hook (handle/transform) â†’ UI (display)
```

## ğŸ“ Code Examples

### âœ… ì˜¬ë°”ë¥¸ êµ¬í˜„ ì˜ˆì‹œ

#### Pages/Components Layer
```typescript
// âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ: Pagesì—ì„œ Hookë§Œ ì‚¬ìš©
import { useProject } from '@prometheus-fe/hooks';
import { Project } from '@prometheus-fe/types';

function ProjectPage() {
  const { projects, fetchProjects, isLoading } = useProject();
  
  useEffect(() => {
    fetchProjects();
  }, []);
  
  return (
    <div>
      {isLoading ? <Loading /> : projects.map(project => ...)}
    </div>
  );
}
```

#### Hooks Layer
```typescript
// âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ: Hookì—ì„œ API ì‚¬ìš©
import { useApi } from '@prometheus-fe/context';
import { Project } from '@prometheus-fe/types';
import { useState, useCallback } from 'react';

export function useProject() {
  const { project } = useApi();
  const [projects, setProjects] = useState<Project[]>([]);
  
  const fetchProjects = useCallback(async (params?: any) => {
    try {
      const data = await project.list(params); // APIë¥¼ í†µí•´ì„œë§Œ
      setProjects(data.projects || []);
    } catch (error) {
      console.error('í”„ë¡œì íŠ¸ ì¡°íšŒ ì‹¤íŒ¨:', error);
      throw error;
    }
  }, [project]);
  
  return { projects, fetchProjects };
}
```

#### API Layer
```typescript
// âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ: APIì—ì„œ DTOì™€ Domain Type ì‚¬ìš©
import { Project } from '@prometheus-fe/types';
import { CreateProjectRequest, CreateProjectDto } from './dto/project.dto';
import { ApiClient } from './apiClient';

export class ProjectApi {
  private apiClient: ApiClient;
  
  async create(formData: any): Promise<CreateProjectDto> {
    // ë°ì´í„° ë³€í™˜ ë¡œì§
    const data: CreateProjectRequest = {
      title: formData.title.trim(),
      // ... ê¸°íƒ€ ë³€í™˜ ë¡œì§
    };
    
    const response = await this.apiClient.post<CreateProjectDto>('/admin/projects/', data);
    return response;
  }
}
```

### âŒ ì˜ëª»ëœ êµ¬í˜„ ì˜ˆì‹œ

```typescript
// âŒ ì˜ëª»ëœ ì˜ˆì‹œ: Pageì—ì„œ ì§ì ‘ API ì‚¬ìš©
import { projectApi } from '@prometheus-fe/api'; // ê¸ˆì§€!
import { CreateProjectRequest } from '@prometheus-fe/api/dto'; // ê¸ˆì§€!

function ProjectPage() {
  const handleCreate = async (data: CreateProjectRequest) => {
    await projectApi.create(data); // ê¸ˆì§€! Hookì„ í†µí•´ì•¼ í•¨
  };
}
```

```typescript
// âŒ ì˜ëª»ëœ ì˜ˆì‹œ: Hookì—ì„œ ì§ì ‘ DTO import
import { CreateProjectRequest } from '@prometheus-fe/api/dto'; // ê¸ˆì§€!

export function useProject() {
  const createProject = async (data: CreateProjectRequest) => {
    // ê¸ˆì§€! APIë¥¼ í†µí•´ì„œë§Œ DTO ì‚¬ìš©
  };
}
```

## ğŸ§ª Testing Rules

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë²”ìœ„
- **Components**: UI ìƒí˜¸ì‘ìš© ë° ë Œë”ë§ í…ŒìŠ¤íŠ¸
- **Hooks**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë° ìƒíƒœ ê´€ë¦¬ í…ŒìŠ¤íŠ¸
- **API**: HTTP ìš”ì²­/ì‘ë‹µ ë° ë°ì´í„° ë³€í™˜ í…ŒìŠ¤íŠ¸
- **Stores**: ì „ì—­ ìƒíƒœ ê´€ë¦¬ í…ŒìŠ¤íŠ¸

### ëª¨í‚¹ ê·œì¹™
- **Pages/Components**: Hooks ëª¨í‚¹
- **Hooks**: API ëª¨í‚¹
- **API**: HTTP í´ë¼ì´ì–¸íŠ¸ ëª¨í‚¹
- **Stores**: ë…ë¦½ì  í…ŒìŠ¤íŠ¸ (ëª¨í‚¹ ìµœì†Œí™”)

## ğŸš€ Development Workflow

### ìƒˆ ê¸°ëŠ¥ ê°œë°œ ìˆœì„œ
1. **Types ì •ì˜**: ë„ë©”ì¸ íƒ€ì… ë¨¼ì € ì •ì˜
2. **DTO ì •ì˜**: API ìš”ì²­/ì‘ë‹µ íƒ€ì… ì •ì˜
3. **API êµ¬í˜„**: HTTP í†µì‹  ë¡œì§ êµ¬í˜„
4. **Hook êµ¬í˜„**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„
5. **UI êµ¬í˜„**: ì»´í¬ë„ŒíŠ¸ ë° í˜ì´ì§€ êµ¬í˜„

### ì½”ë“œ ë¦¬ë·° ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] Import ì œí•œ ë£° ì¤€ìˆ˜ ì—¬ë¶€
- [ ] ê³„ì¸µë³„ ì±…ì„ ë¶„ë¦¬ ì¤€ìˆ˜ ì—¬ë¶€
- [ ] ë„¤ì´ë° ì»¨ë²¤ì…˜ ì¤€ìˆ˜ ì—¬ë¶€
- [ ] ë‹¨ë°©í–¥ ì˜ì¡´ì„± ì¤€ìˆ˜ ì—¬ë¶€
- [ ] ì ì ˆí•œ ì—ëŸ¬ ì²˜ë¦¬ ì—¬ë¶€

## ğŸ“ˆ Benefits of This Architecture

1. **ëª…í™•í•œ ì±…ì„ ë¶„ë¦¬**: ê° ê³„ì¸µì´ ê³ ìœ í•œ ì—­í• ë§Œ ìˆ˜í–‰
2. **ë†’ì€ ì¬ì‚¬ìš©ì„±**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ UIì— ë…ë¦½ì 
3. **ì‰¬ìš´ í…ŒìŠ¤íŠ¸**: ê° ê³„ì¸µì„ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
4. **ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ**: ë³€ê²½ ì‚¬í•­ì˜ ì˜í–¥ ë²”ìœ„ ìµœì†Œí™”
5. **ê°œë°œ íš¨ìœ¨ì„±**: ê°œë°œìê°€ ì–´ë””ì— ë¬´ì—‡ì„ êµ¬í˜„í•´ì•¼ í• ì§€ ëª…í™•
6. **íŒ€ í˜‘ì—… í–¥ìƒ**: ì¼ê´€ëœ êµ¬ì¡°ë¡œ ì½”ë“œ ì´í•´ë„ ì¦ëŒ€

## ğŸ”§ Migration Guidelines

ê¸°ì¡´ ì½”ë“œë¥¼ ì´ êµ¬ì¡°ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•  ë•Œ:

1. **Types ë¨¼ì € ë¶„ë¦¬**: ë„ë©”ì¸ íƒ€ì…ì„ ë…ë¦½ì ìœ¼ë¡œ ë¶„ë¦¬
2. **API ê³„ì¸µ ì •ë¦¬**: DTOì™€ API ë¡œì§ ë¶„ë¦¬
3. **Hook ë¦¬íŒ©í† ë§**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ Hookìœ¼ë¡œ ì´ë™
4. **Component ì •ë¦¬**: UI ë¡œì§ë§Œ ë‚¨ê¸°ê³  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì œê±°
5. **Import ì •ë¦¬**: ê³„ì¸µë³„ Import ì œí•œ ì ìš©

---

*ì´ ë¬¸ì„œëŠ” Prometheus í”„ë¡œì íŠ¸ì˜ ì½”ë“œ í’ˆì§ˆê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•œ ê°€ì´ë“œë¼ì¸ì…ë‹ˆë‹¤. ìƒˆë¡œìš´ ìš”êµ¬ì‚¬í•­ì´ë‚˜ ê¸°ìˆ  ë³€í™”ì— ë”°ë¼ ì§€ì†ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.*